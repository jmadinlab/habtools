<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Metrics of fractal dimension • habtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Metrics of fractal dimension">
<meta property="og:description" content="habtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">habtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DEM_intro.html">Complexity metrics for DEMs</a>
    </li>
    <li>
      <a href="../articles/fractal_intro.html">Metrics of fractal dimension</a>
    </li>
    <li>
      <a href="../articles/mesh_intro.html">Complexity metrics for 3D meshes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Metrics of fractal dimension</h1>
            
      
      
      <div class="hidden name"><code>fractal_intro.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">habtools</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: sp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'raster'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:habtools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extent</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:raster':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, select, union</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette, we give a brief overview of fractal dimension
methods in <code>habtools</code>. We highlight that each method has
inherent biases and should be used cautiously and consistently. For
example, some methods are sensitive to particular elements, like
outliers, z-scaling or drop-offs, where others are invariant to
them.</p>
<div class="section level4">
<h4 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h4>
<p>There are currently five fractal dimension methods in
<code>habtools</code>: <code>hvar</code>, <code>sd</code>,
<code>area</code>, <code>cubes</code> and <code>boxes</code>. The first
four can be applied to DEMs. <code>area</code> and <code>cubes</code>
can be applied to meshes. <code>boxes</code> can only be applied to 2D
outlines, such as generated using the <code>mesh_to_2D</code> function
that generates the planar outline of a 3D mesh. There are detailed help
files explain how they work and point to references.</p>
</div>
<div class="section level4">
<h4 id="the-length-vectors-lvec">The length vectors (<code>lvec</code>)<a class="anchor" aria-label="anchor" href="#the-length-vectors-lvec"></a>
</h4>
<p>In general, fractal dimension is estimated by measuring values (e.g.,
counts of cubes, heights, areas) at a sequence of different resolutions
or length scales, and then finding the slope between these scales and
the measured values. Therefore, selecting a sensible sequence of scales
is critical, and can differ among methods. If you don’t enter an
<code>lvec</code>, the function will estimate one for you based on some
rules of thumb.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate fractal terrain</span></span>
<span><span class="va">surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_terrain.html">sim_terrain</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">128</span>, smoothness<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># fractal dimension using height variation method</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf</span>, method<span class="op">=</span><span class="st">"hvar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64, 128).</span></span>
<span><span class="co">#&gt; [1] 2.487394</span></span></code></pre></div>
<p>For example the height variation method will generate a log2 sequence
of length between the resolution x 10 and the extent. So in this
example,</p>
<p>The largest scale <code>L</code> is typically that of the object of
surface. For example, for a section of terrain 1 x 1 m, L would be 1 if
using the height range of .</p>
<p>All fractal dimension methods in <code>habtools</code> will
automatically generate a vector of scales (<code>lvec</code>) based on
rules of thumb, which differ among methods.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate fractal terrain</span></span>
<span><span class="va">surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_terrain.html">sim_terrain</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">256</span>, smoothness <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># fractal dimension using height variation method</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf</span>, method<span class="op">=</span><span class="st">"hvar"</span>, diagnose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64, 128, 256).</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $D</span></span>
<span><span class="co">#&gt; [1] 2.523926</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt;     l         h</span></span>
<span><span class="co">#&gt; 1   8 0.2788028</span></span>
<span><span class="co">#&gt; 2  16 0.4317595</span></span>
<span><span class="co">#&gt; 3  32 0.6174781</span></span>
<span><span class="co">#&gt; 4  64 0.8370791</span></span>
<span><span class="co">#&gt; 5 128 1.0647181</span></span>
<span><span class="co">#&gt; 6 256 1.5376634</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lvec</span></span>
<span><span class="co">#&gt; [1]   8  16  32  64 128 256</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $D_vec</span></span>
<span><span class="co">#&gt; [1] 2.369017 2.483840 2.561024 2.652964 2.469732</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 0.1062876</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "hvar"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="length-vectors-lvec">Length vectors (<code>lvec</code>)<a class="anchor" aria-label="anchor" href="#length-vectors-lvec"></a>
</h2>
</div>
<div class="section level2">
<h2 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h2>
</div>
<div class="section level2">
<h2 id="simulated-surfaces">Simulated surfaces<a class="anchor" aria-label="anchor" href="#simulated-surfaces"></a>
</h2>
</div>
<div class="section level2">
<h2 id="height-invariance-z-scale">Height invariance (<code>z-scale</code>)<a class="anchor" aria-label="anchor" href="#height-invariance-z-scale"></a>
</h2>
</div>
<div class="section level2">
<h2 id="non-fractal-surfaces">Non-fractal surfaces<a class="anchor" aria-label="anchor" href="#non-fractal-surfaces"></a>
</h2>
</div>
<div class="section level2">
<h2 id="fractal-terrain">Fractal terrain<a class="anchor" aria-label="anchor" href="#fractal-terrain"></a>
</h2>
<p>The first simulated surface included with <code>habtools</code>
utilizes the diamond-square algorithm. Here is a relatively flat
simulated terrain.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate 64 by 64 unit surface with smoothness of 1 (less fractal)</span></span>
<span><span class="va">surf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_terrain.html">sim_terrain</a></span><span class="op">(</span><span class="fl">64</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surf1</span><span class="op">)</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Here are estimates of fractal dimension for the three methods.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># height variation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"hvar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.326891</span></span>
<span></span>
<span><span class="co"># standard deviation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.39469</span></span>
<span></span>
<span><span class="co"># area</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(2, 4, 8, 16).</span></span>
<span><span class="co">#&gt; [1] 2.000063</span></span>
<span></span>
<span><span class="co"># cube counting</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"cubes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>The height variation method estimates that fractal dimension is high,
whereas the other two method estimate that it is low. This is because
the height range method is invariant to z-scaling. To demonstrate,
height of <code>surf1</code> is scaled to equal to the extent.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># standardize the surface height to match the extent (i.e., 63 midpoints)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">64</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0 63</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surf1</span><span class="op">)</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-6-1.png" width="700">
Here are estimates of fractal dimension for the three methods.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># height variation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"hvar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.326891</span></span>
<span></span>
<span><span class="co"># standard deviation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.39469</span></span>
<span></span>
<span><span class="co"># area</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(2, 4, 8, 16).</span></span>
<span><span class="co">#&gt; [1] 2.216242</span></span>
<span></span>
<span><span class="co"># cube counting</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf1</span>, method <span class="op">=</span> <span class="st">"cubes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.531071</span></span></code></pre></div>
<p>You can see that the height variation estimate remains unchanged,
whereas the area and cubes estimates increase. We believe this dichotomy
raises an underlying philosophical question about fractal surfaces: does
the fractal dimension of an surface change if it is scaled along one
dimension?</p>
<p>There are a variety of ways to explore this question. Let’s start by
simulating a rough terrain.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate 64 by 64 unit surface with smoothness of 0 (more fractal)</span></span>
<span><span class="va">surf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_terrain.html">sim_terrain</a></span><span class="op">(</span><span class="fl">64</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surf2</span><span class="op">)</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Here are estimates of fractal dimension for the three methods.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># height variation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"hvar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.721656</span></span>
<span></span>
<span><span class="co"># standard deviation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.894103</span></span>
<span></span>
<span><span class="co"># area</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(2, 4, 8, 16).</span></span>
<span><span class="co">#&gt; [1] 2.017233</span></span>
<span></span>
<span><span class="co"># cube counting</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"cubes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>The height variation estimate for fractal dimension is high (closer
to 3), the area estimate is the same as for the smooth terrain (close to
2), and the cubes estimate is somewhere in-between. This suggests that
invariance to z-scaling is better at estimating surface roughness. Let’s
now scale the rough terrain.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># standardize the surface height to match the extent (i.e., 63 midpoints)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">64</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">surf2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0 63</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surf2</span><span class="op">)</span></span></code></pre></div>
<p><img src="fractal_intro_files/figure-html/unnamed-chunk-10-1.png" width="700">
Here are estimates of fractal dimension for the three methods.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># height variation</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"hvar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.721656</span></span>
<span></span>
<span><span class="co"># area</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(2, 4, 8, 16).</span></span>
<span><span class="co">#&gt; [1] 2.538922</span></span>
<span></span>
<span><span class="co"># cube counting</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">surf2</span>, method <span class="op">=</span> <span class="st">"cubes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(8, 16, 32, 64).</span></span>
<span><span class="co">#&gt; [1] 2.831853</span></span></code></pre></div>
<p>When the z-values are scaled, the area estimate approaches the height
variation estimate; the latter of which is unchanged by the
transformation. Let’s simulate multiple surfaces</p>
<!-- ```{r} -->
<!-- i <- 50 -->
<!-- # simluate i smooth terrains -->
<!-- surf_smooth <- lapply(1:i, function(x) { sim_terrain(64, 1) }) -->
<!-- # height variation -->
<!-- hvar_smooth <- sapply(surf_smooth, fd,  method = "hvar", parallel=TRUE) -->
<!-- # area -->
<!-- area_smooth <- sapply(surf_smooth, fd,  method = "area") -->
<!-- # cube counting -->
<!-- cube_smooth <- sapply(surf_smooth, fd,  method = "cubes") -->
<!-- dat <- data.frame(z_scale=rep("z_scale=FALSE", 3*i), smoothness=rep("smooth", 3*i), method=c(rep("hvar", i), rep("area", i), rep("cubes", i)), fd=c(hvar_smooth, area_smooth, cube_smooth)) -->
<!-- surf_smooth_z <- lapply(1:i, function(x) { sim_terrain(64, 1, z_extent = TRUE) }) -->
<!-- # height variation -->
<!-- hvar_smooth_z <- sapply(surf_smooth_z, fd,  method = "hvar", parallel=TRUE) -->
<!-- # area -->
<!-- area_smooth_z <- sapply(surf_smooth_z, fd,  method = "area") -->
<!-- # cube counting -->
<!-- cube_smooth_z <- sapply(surf_smooth_z, fd,  method = "cubes") -->
<!-- dat <- rbind(dat, data.frame(z_scale=rep("z_scale=TRUE", 3*i), smoothness=rep("smooth", 3*i), method=c(rep("hvar", i), rep("area", i), rep("cubes", i)), fd=c(hvar_smooth_z, area_smooth_z, cube_smooth_z))) -->
<!-- ### 10 simulated rough terrains -->
<!-- surf_rough <- lapply(1:i, function(x) { sim_terrain(64, 0) }) -->
<!-- # height variation -->
<!-- hvar_rough <- sapply(surf_rough, fd,  method = "hvar", parallel=TRUE) -->
<!-- # area -->
<!-- area_rough <- sapply(surf_rough, fd,  method = "area") -->
<!-- # cube counting -->
<!-- cube_rough <- sapply(surf_rough, fd,  method = "cubes") -->
<!-- dat <- rbind(dat, data.frame(z_scale=rep("z_scale=FALSE", 3 * i), smoothness=rep("rough", 3 * i), method=c(rep("hvar", i), rep("area", i), rep("cubes", i)), fd=c(hvar_rough, area_rough, cube_rough))) -->
<!-- surf_rough_z <- lapply(1:i, function(x) { sim_terrain(64, 0, z_extent = TRUE) }) -->
<!-- # height variation -->
<!-- hvar_rough_z <- sapply(surf_rough_z, fd,  method = "hvar", parallel=TRUE) -->
<!-- # area -->
<!-- area_rough_z <- sapply(surf_rough_z, fd,  method = "area") -->
<!-- # cube counting -->
<!-- cube_rough_z <- sapply(surf_rough_z, fd,  method = "cubes") -->
<!-- dat <- rbind(dat, data.frame(z_scale=rep("z_scale=TRUE", 3 *i), smoothness=rep("rough", 3*i), method=c(rep("hvar", i), rep("area", i), rep("cubes", i)), fd=c(hvar_rough_z, area_rough_z, cube_rough_z))) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- ggplot(dat[dat$method != "cubes",], aes(x = method, y = fd)) +  -->
<!--   geom_boxplot(outlier.shape = NA) + -->
<!--   geom_jitter(colour = 4) + -->
<!--   facet_grid(smoothness ~ z_scale) -->
<!-- ``` -->
<!-- ```{r fig.width=7, fig.height=7, echo=FALSE} -->
<!-- par(mfrow=c(2, 2)) -->
<!-- smoothness <- 0 -->
<!-- z_extent <- FALSE -->
<!-- lvec <- c(2, 4, 8) -->
<!-- fd(surf1, lvec, method = "hvar", diagnose = T) -->
<!-- fd(surf1, method = "area", diagnose = T) -->
<!-- fd(surf1, lvec, method = "cubes", diagnose = T) -->
<!-- dev.off() -->
<!-- par(mfrow=c(2, 2)) -->
<!-- z_extent <- TRUE -->
<!-- surf2 <- sim_terrain(64, smoothness, z_extent) -->
<!-- plot(surf2, asp=1, main=paste0("smoothness = ", smoothness, "\n", "z_extent = ", z_extent)) -->
<!-- fd(surf2, method = "hvar", diagnose = T) -->
<!-- fd(surf2, method = "area", diagnose = T) -->
<!-- fd(surf2, method = "cubes", diagnose = T) -->
<!-- ``` -->
<!-- ### High smoothness -->
<!-- ```{r fig.width=7, fig.height=7, echo=FALSE} -->
<!-- par(mfrow=c(2, 2)) -->
<!-- smoothness <- 1 -->
<!-- z_extent <- FALSE -->
<!-- surf1 <- sim_terrain(64, smoothness, z_extent) -->
<!-- lvec <- c(4, 8, 16, 32, 64) -->
<!-- plot(surf1, asp=1, main=paste0("smoothness = ", smoothness, "\n", "z_extent = ", z_extent)) -->
<!-- fd(surf1, method = "hvar", diagnose = T) -->
<!-- fd(surf1, method = "area", diagnose = T) -->
<!-- fd(surf1, method = "cubes", diagnose = T) -->
<!-- par(mfrow=c(2, 2)) -->
<!-- z_extent <- TRUE -->
<!-- surf2 <- sim_terrain(64, smoothness, z_extent) -->
<!-- plot(surf2, asp=1, main=paste0("smoothness = ", smoothness, "\n", "z_extent = ", z_extent)) -->
<!-- fd(surf2, method = "hvar", diagnose = T) -->
<!-- fd(surf2, method = "area", diagnose = T) -->
<!-- fd(surf2, method = "cubes", diagnose = T) -->
<!-- ``` -->
<!-- # Real reef -->
<!-- ```{r fig.width=7, fig.height=7, echo=FALSE} -->
<!-- par(mfrow=c(2, 2)) -->
<!-- surf1 <- crop(horseshoe, raster::extent(horseshoe, 1, 128, 1, 128)) -->
<!-- res <- raster::res(surf1) -->
<!-- values(surf1) <- values(surf1) - min(values(surf1)) -->
<!-- lvec <- c(4, 8, 16, 32, 64, 128) * res -->
<!-- plot(surf1, asp=1, main=paste0("horseshoe\n", "z_extent = FALSE")) -->
<!-- fd(surf1, method = "hvar", diagnose = T) -->
<!-- fd(surf1, method = "area", diagnose = T) -->
<!-- fd(surf1, method = "cubes", diagnose = T) -->
<!-- par(mfrow=c(2, 2)) -->
<!-- surf2 <- surf1 -->
<!-- values(surf2) <- values(surf1) * (res*128) / max(values(surf1)) -->
<!-- range(values(surf2)) -->
<!-- plot(surf2, main=paste0("horseshoe\n", "z_extent = TRUE")) -->
<!-- fd(surf2, method = "hvar", diagnose = T) -->
<!-- fd(surf2, method = "area", diagnose = T) -->
<!-- fd(surf2, method = "cubes", diagnose = T) -->
<!-- ``` -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joshua Madin, Nina Schiettekatte.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

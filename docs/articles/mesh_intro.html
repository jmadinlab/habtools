<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Complexity metrics for 3D meshes • habtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Complexity metrics for 3D meshes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">habtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/DEM_intro.html">Complexity metrics for DEMs</a></li>
    <li><a class="dropdown-item" href="../articles/fractal_intro.html">Fractal dimension methods</a></li>
    <li><a class="dropdown-item" href="../articles/mesh_intro.html">Complexity metrics for 3D meshes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmadinlab/habtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Complexity metrics for 3D meshes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jmadinlab/habtools/blob/HEAD/vignettes/mesh_intro.Rmd" class="external-link"><code>vignettes/mesh_intro.Rmd</code></a></small>
      <div class="d-none name"><code>mesh_intro.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jmadinlab.github.io/habtools/">habtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl" class="external-link">rgl</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>rgl.printRglwidget <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="checking-your-mesh">Checking your mesh<a class="anchor" aria-label="anchor" href="#checking-your-mesh"></a>
</h2>
<p><code>habtools</code> includes a wide range of 3D metrics applicable
to meshes.</p>
<p>Before calculating any metrics, visualize your mesh and make sure
that the z orientation is correct, as this may affect some of the
calculations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/README-setup2-1-rgl.png"></p>
<p>Depending on how the mesh was generated (e.g. with the use of a laser
scanner), the resolutions (distance between vertices inside the mesh)
can vary a lot. This may affect calculations such as fractal dimension.
Check the distribution of resolution of your object and if needed,
remesh to make the resolution more uniform.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resvec</span> <span class="op">&lt;-</span> <span class="fu">Rvcg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rvcg/man/vcgMeshres.html" class="external-link">vcgMeshres</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="co"># vector of resolutions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">resvec</span><span class="op">)</span></span></code></pre></div>
<p><img src="mesh_intro_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">resvec</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">#&gt; 0.001307 0.005265 0.007003 0.007831 0.009410 0.043981</span></span></code></pre></div>
<p>In our example, the <code>mcap</code> object has very variable
distances between vertices. We can solve this issue by re-meshing the
object with the Rvcg function <code>vgcUniformRemesh()</code>. Here we
set the resolution (voxelSize) to the minimum distance between points in
the original mesh to ensure we don’t loose details. This choice may be
made on a case-to-case basis. Setting <code>multisample=TRUE</code>
improves the accuracy of distance field computation, but slows down the
calculation so this choice may be defined by computing power and the
size of your object. The re-meshed object now has a mean resolution of
approximately the minimum of <code>resvec</code>. While there will still
be some variation in the obtained distances between vertices, the
variation will be much smaller. An alternative option would be to
re-mesh using an external 3D software such as blender.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcap_uniform</span> <span class="op">&lt;-</span> <span class="fu">Rvcg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rvcg/man/vcgUniformRemesh.html" class="external-link">vcgUniformRemesh</a></span><span class="op">(</span><span class="va">mcap</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, multiSample <span class="op">=</span> <span class="cn">TRUE</span>, voxelSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">resvec</span><span class="op">)</span>, mergeClost <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">Rvcg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rvcg/man/vcgMeshres.html" class="external-link">vcgMeshres</a></span><span class="op">(</span><span class="va">mcap_uniform</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.001328214</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">Rvcg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rvcg/man/vcgMeshres.html" class="external-link">vcgMeshres</a></span><span class="op">(</span><span class="va">mcap_uniform</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span><span class="co">#&gt; 0.0003464 0.0010450 0.0013561 0.0013282 0.0016327 0.0026663</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="complexity-metrics-r-d-and-h">Complexity metrics: R, D, and H<a class="anchor" aria-label="anchor" href="#complexity-metrics-r-d-and-h"></a>
</h2>
<p>The three main metrics for DEMs also work for meshes. The recommended
method for fractal dimension is <code>cubes</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fractal dimension</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">mcap_uniform</span>, method <span class="op">=</span> <span class="st">"cubes"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, diagnose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lvec is set to c(0.003, 0.006, 0.012, 0.024, 0.048, 0.096, 0.192, 0.385).</span></span></code></pre></div>
<p><img src="mesh_intro_files/figure-html/unnamed-chunk-5-1.png" width="384"><img src="mesh_intro_files/figure-html/unnamed-chunk-5-2.png" width="384"></p>
<pre><code><span><span class="co">#&gt; $D</span></span>
<span><span class="co">#&gt; [1] 2.134741</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt;             l     n</span></span>
<span><span class="co">#&gt; 8 0.003006817 38169</span></span>
<span><span class="co">#&gt; 7 0.006013634 10463</span></span>
<span><span class="co">#&gt; 6 0.012027269  2715</span></span>
<span><span class="co">#&gt; 5 0.024054537   673</span></span>
<span><span class="co">#&gt; 4 0.048109075   162</span></span>
<span><span class="co">#&gt; 3 0.096218149    34</span></span>
<span><span class="co">#&gt; 2 0.192436298     8</span></span>
<span><span class="co">#&gt; 1 0.384872597     1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lvec</span></span>
<span><span class="co">#&gt; [1] 0.384872597 0.192436298 0.096218149 0.048109075 0.024054537 0.012027269</span></span>
<span><span class="co">#&gt; [7] 0.006013634 0.003006817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $D_vec</span></span>
<span><span class="co">#&gt; [1] 1.867105 1.946272 2.012274 2.054613 2.252387 2.087463 3.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 0.3834844</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "cubes"</span></span></code></pre>
<div class="section level3">
<h3 id="rugosity">Rugosity<a class="anchor" aria-label="anchor" href="#rugosity"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rugosity</span></span>
<span><span class="fu"><a href="../reference/rg.html">rg</a></span><span class="op">(</span><span class="va">mcap_uniform</span><span class="op">)</span></span>
<span><span class="co">#&gt; L0 is set to mesh resolution (0.00132821395068341)</span></span>
<span><span class="co">#&gt; [1] 3.145419</span></span>
<span></span>
<span><span class="co"># height range </span></span>
<span><span class="fu"><a href="../reference/hr.html">hr</a></span><span class="op">(</span><span class="va">mcap_uniform</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2204218</span></span></code></pre></div>
<p>For fractal dimension, two methods are available: <code>cubes</code>
and <code>area</code>. In the <code>cubes</code> method, fractal
dimension is calculated as the slope of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mn>10</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>10</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">log10(n) \sim log10(l)</annotation></semantics></math>,
where <code>n</code> is the total number of cubes that contains any
surface of the object and <code>l</code> is the size of the cubes
(elements of <code>lvec</code>). In the <code>area</code> method, the
mesh is re-meshed at varying resolutions (<code>lvec</code>). Further,
you can calculate planar and total surface area of the object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/planar.html">planar</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; L0 is set to mesh resolution (0.00783124724167033)</span></span>
<span><span class="co">#&gt; [1] 0.08368526</span></span>
<span><span class="fu"><a href="../reference/surface_area.html">surface_area</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2698101</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="shape-metrics">Shape Metrics<a class="anchor" aria-label="anchor" href="#shape-metrics"></a>
</h2>
<p>There are a number of other metrics that tell you more about the
shape of the object. See Zawada et al. (2019) for an example of an
application of these metrics on corals.</p>
<ul>
<li>
<strong>Convexity:</strong> the ratio of the volume of the object
and the volume of the convex hull around the object.<br>
</li>
<li>
<strong>Packing:</strong> The ratio of the surface area of the
object and the surface area of the convex hull around the object.<br>
</li>
<li>
<strong>Sphericity:</strong> The ratio of the surface area of a
sphere with the same volume as the object and the surface area of the
object.<br>
</li>
<li>
<strong>Second moment of area (<code>sma</code>):</strong> A measure
of top-heaviness using area. Calculated by multiplying the surface area
of each triangle in the mesh by its vertical distance from the
origin.<br>
</li>
<li>
<strong>Second moment of volume (<code>smv</code>):</strong> A
measure of top-heaviness using volume. For each triangle in the mesh, a
tetrahedron between the triangle and the origin was calculated. The
signed volume of each tetrahedron was multiplied by the vertical
distance between the centroid of the tetrahedron and the centroid of the
attachment plane.<br>
</li>
<li>
<strong>Mechanical shape factor (<code>csf</code>):</strong>
Mechanical vulnerability of a structural element (Madin &amp; Connolly,
2006).</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convexity</span></span>
<span><span class="fu"><a href="../reference/convexity.html">convexity</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4484716</span></span>
<span></span>
<span><span class="co"># packing</span></span>
<span><span class="fu"><a href="../reference/packing.html">packing</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8642852</span></span>
<span></span>
<span><span class="co"># sphericity</span></span>
<span><span class="fu"><a href="../reference/sphericity.html">sphericity</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6056971</span></span>
<span></span>
<span><span class="co"># second moment of area</span></span>
<span><span class="fu"><a href="../reference/sma.html">sma</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03294466</span></span>
<span></span>
<span><span class="co"># second moment of volume</span></span>
<span><span class="fu"><a href="../reference/smv.html">smv</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0005450781</span></span>
<span></span>
<span><span class="co"># mechanical shape factor</span></span>
<span><span class="fu"><a href="../reference/csf.html">csf</a></span><span class="op">(</span><span class="va">mcap</span><span class="op">)</span></span>
<span><span class="co">#&gt; z_min set to -3.74007153511047</span></span>
<span><span class="co">#&gt; resolution set to 0.00783124724167033</span></span>
<span><span class="co">#&gt; [1] 1816.815</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transform-mesh-into-a-dem-or-2d-shape">Transform mesh into a DEM or 2D shape<a class="anchor" aria-label="anchor" href="#transform-mesh-into-a-dem-or-2d-shape"></a>
</h2>
<p>You can also transform a 3D mesh to a DEM, and then apply DEM
functions to the surface.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mesh_to_dem.html">mesh_to_dem</a></span><span class="op">(</span><span class="va">mcap_uniform</span>, res <span class="op">=</span> <span class="fl">0.002</span>, fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span></code></pre></div>
<p><img src="mesh_intro_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rg.html">rg</a></span><span class="op">(</span><span class="va">dem</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 2.767167</span></span></code></pre></div>
<p>You can also transform a 3D mesh to a 2D drawing, and then apply 2D
functions to the object. Note that fractal dimension ranges between 1
and 2 for 2D drawings, rather than 2 and 3 for 3D meshes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mesh_to_2d.html">mesh_to_2d</a></span><span class="op">(</span><span class="va">mcap_uniform</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pts</span>, asp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="mesh_intro_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># perimeter</span></span>
<span><span class="fu"><a href="../reference/perimeter.html">perimeter</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.705922</span></span>
<span></span>
<span><span class="co"># circularity</span></span>
<span><span class="fu"><a href="../reference/circularity.html">circularity</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6123799</span></span>
<span></span>
<span><span class="co"># fractal dimension</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">pts</span>, method <span class="op">=</span> <span class="st">"boxes"</span>, keep_data <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="mesh_intro_files/figure-html/unnamed-chunk-10-2.png" width="384"></p>
<pre><code><span><span class="co">#&gt; [1] 1.216126</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Zawada KJA, Dornelas M, Madin JS (2019) Quantifying coral
morphology. Coral Reefs, 38:1281–1292.<br>
</li>
<li>Madin JS &amp; Connolly SR (2006) Ecological consequences of major
hydrodynamic disturbances on coral reefs. Nature. 444:477-480.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua Madin, Nina Schiettekatte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>

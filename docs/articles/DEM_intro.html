<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Complexity metrics for DEMs • habtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Complexity metrics for DEMs">
<meta property="og:description" content="habtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">habtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DEM_intro.html">Complexity metrics for DEMs</a>
    </li>
    <li>
      <a href="../articles/fractal_intro.html">Metrics of fractal dimension</a>
    </li>
    <li>
      <a href="../articles/mesh_intro.html">Complexity metrics for DEMs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Complexity metrics for DEMs</h1>
            
      
      
      <div class="hidden name"><code>DEM_intro.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">habtools</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: sp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'raster'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:habtools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extent</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:raster':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, select, union</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette, we go over the basic steps to calculate standard
complexity metrics for digital elevation models (DEMs). In this example,
we use a DEM of 8x8m with a resolution of 0.01m.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a raster</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="va">horseshoe</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01 0.01</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span></code></pre></div>
<p><img src="DEM_intro_files/figure-html/unnamed-chunk-2-1.png" width="700">
Let’s say we want complexity metrics for a certain square of size 2m
around xy-coordinates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_dem.html">crop_dem</a></span><span class="op">(</span><span class="va">horseshoe</span>, x0 <span class="op">=</span> <span class="op">-</span><span class="fl">466</span>, y0 <span class="op">=</span> <span class="fl">1269</span>, L <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="DEM_intro_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem1</span><span class="op">)</span></span></code></pre></div>
<p><img src="DEM_intro_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="section level2">
<h2 id="height-range">Height range<a class="anchor" aria-label="anchor" href="#height-range"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hr.html">hr</a></span><span class="op">(</span><span class="va">dem1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9766939</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rugosity">Rugosity<a class="anchor" aria-label="anchor" href="#rugosity"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Height variation method</span></span>
<span><span class="fu"><a href="../reference/rg.html">rg</a></span><span class="op">(</span><span class="va">dem1</span>, L0 <span class="op">=</span> <span class="fl">0.1</span>, method <span class="op">=</span> <span class="st">"hvar"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Parallel = TRUE enables parallel processing using multiple cores to speed up the calculations using the height variation method. Only use this if you have a powerful computer with at least four cores. </span></span>
<span><span class="co">#&gt; [1] 1.596596</span></span>
<span>           </span>
<span><span class="co"># Area method</span></span>
<span><span class="fu"><a href="../reference/rg.html">rg</a></span><span class="op">(</span><span class="va">dem1</span>, L0 <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.696857</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fractal-dimension">Fractal dimension<a class="anchor" aria-label="anchor" href="#fractal-dimension"></a>
</h2>
<div class="section level3">
<h3 id="height-variation-method">Height variation method<a class="anchor" aria-label="anchor" href="#height-variation-method"></a>
</h3>
<p>The height variation method is based on the relationship between
height range and scale. Basically, the DEM is divided into small squares
with sizes specified in <code>lvec</code>. Within each square, the
height range is calculated and logged. This results in a data frame with
many height ranges (depending on the scale). This data is then
summarized by taking the mean or median. The fractal dimension is
finally calculated as: <span class="math display">\[D = 3- b,\]</span>
with b being the slope of the linear regression between height range (h)
and scale (l) <span class="math inline">\(log(h) \sim log(l)\)</span>.
Because a range of values is needed to calculate a height range the
smallest value of <code>lvec</code> should always be at least two times
the resolution of the DEM, and up to 10 times bigger. The largest value
should be the extent of the DEM square. We suggest to choose a vector of
doubling values for <code>lvec</code>. For example, if the resolution =
0.01m and the extent = 2m, we could choose <code>lvec</code> =
<code>c(0.125, 0.25, 0.5, 1, 2)</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Height variation method</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">dem1</span>, lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">T</span>, method <span class="op">=</span> <span class="st">"hvar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DEM_intro_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; [1] 2.284862</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="area-method">Area method<a class="anchor" aria-label="anchor" href="#area-method"></a>
</h3>
<p>The area method operates quite differently and is therefore not
comparable to the height variation method described above. This method
uses surface areas at varying scales and calculates the fractal
dimension as: <span class="math display">\[D = 2 - b,\]</span> where b
is the slope of the linear regression between surface area (a) and scale
(l): <span class="math inline">\(log(a) \sim log(l)\)</span>. The
surface area is calculated at each scale by aggregating the DEM to the
resolution of that scale by taking the median. Similar to the above
method, we suggest a doubling vector for <code>lvec</code>. However, the
smallest scale can be as small as the resolution of the DEM and the
largest scale should not approach the extent DEM.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Area method</span></span>
<span><span class="fu"><a href="../reference/fd.html">fd</a></span><span class="op">(</span><span class="va">dem1</span>, lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03125</span>, <span class="fl">0.0625</span>, <span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">T</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DEM_intro_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; [1] 2.222356</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="multiple-metrics">Multiple metrics<a class="anchor" aria-label="anchor" href="#multiple-metrics"></a>
</h2>
<p>Note that the resolution (L0) for the rugosity will be set as the
smallest value of <code>lvec</code> in the <code><a href="../reference/rdh.html">rdh()</a></code>
function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rdh.html">rdh</a></span><span class="op">(</span><span class="va">dem1</span>, lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"hvar"</span><span class="op">)</span></span>
<span><span class="co">#&gt;          R        D         H</span></span>
<span><span class="co">#&gt; 1 1.518349 2.284862 0.9766939</span></span>
<span><span class="fu"><a href="../reference/rdh.html">rdh</a></span><span class="op">(</span><span class="va">dem1</span>, lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03125</span>, <span class="fl">0.0625</span>, <span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt;          R        D         H</span></span>
<span><span class="co">#&gt; 1 1.824223 2.222356 0.9766939</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multiple-squares">Multiple squares<a class="anchor" aria-label="anchor" href="#multiple-squares"></a>
</h2>
<p>The function <code><a href="../reference/split_dem.html">split_dem()</a></code> allows you to subdivide a DEM
into equal parts. Let’s divide the big raster into 2x2m squares. Note
that this function will only work well if you have a square DEM. You
also want to choose the size so that the DEM can be divided into equal
parts.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/split_dem.html">split_dem</a></span><span class="op">(</span><span class="va">dem</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># calculate one metric for all squares</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">dem_list</span>, <span class="va">hr</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.5169915 0.6127143 0.8386080 0.8948447 0.6774140 0.9407243 0.9958876</span></span>
<span><span class="co">#&gt;  [8] 0.9968966 1.1133886 1.0766171 1.1218033 1.0029795 0.9923673 1.1646364</span></span>
<span><span class="co">#&gt; [15] 0.9986641 1.3692834</span></span>
<span></span>
<span><span class="co"># calculate multiple metrics</span></span>
<span><span class="va">data_rdh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dem_list</span>, <span class="va">rdh</span>,  method <span class="op">=</span> <span class="st">"hvar"</span>, lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_rdh</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">R</span>, y <span class="op">=</span> <span class="va">H</span>, color <span class="op">=</span> <span class="va">D</span>, size <span class="op">=</span> <span class="va">D</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="DEM_intro_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="rules-of-thumb">Rules of thumb<a class="anchor" aria-label="anchor" href="#rules-of-thumb"></a>
</h2>
<ul>
<li>When analyzing and comparing multiple DEMs, make sure that each DEM
has the same resolution.</li>
<li>When using the “hvar” method, the smallest value of
<code>lvec</code>should be between two times and ten higher than the
resolution</li>
<li>When using the “hvar” method, the extent (highest value of
<code>lvec</code>) should ideally be 1 to 2 orders of magnitudes higher
compared to smallest value of <code>lvec</code> or <code>lvec</code>
values should match scales of particular interest (e.g. matching body
sizes of animals inhabiting the surface)</li>
<li>
<code>lvec</code> and chosen method needs to be the same across all
calculations to make comparisons</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joshua Madin, Nina Schiettekatte.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

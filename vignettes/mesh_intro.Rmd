---
title: "Complexity metrics for 3D meshes"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Complexity metrics for 3D meshes}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(habtools)
library(rgl)
options(rgl.printRglwidget = TRUE)
```

*habtools* includes a wide range of complexity metrics applicable to 3D meshes. 


```{r}
plot3d(mcap)
```


The three main metrics for DEMs also work for meshes. 
```{r}
# fractal dimension
fd(mcap, method = "cubes", lvec = c(0.045, 0.09, 0.18, 0.5), plot = TRUE)
fd(mcap, method = "area", lvec = c(0.01, 0.02, 0.04, 0.08), plot = TRUE)

# rugosity
rg(mcap)

# height range 
hr(mcap)

```

For fractal dimension, two methods are available: "cubes" and "area". 
In the "cubes" method, fractal dimension is calculated as the slope of $log10(n) \sim log10(l)$, where n is the total number of cubes that contains any surface of the object and l is the size of the cubes (elements of lvec).
In the "area" method, the mesh is remeshed at varying resolutions (lvec).
Further, you can calculate planar and total surface area of the object.
```{r}
planar(mcap)
surface_area(mcap)
```

              
There are a number of other metrics that tell you more about the shape of the object. See Zawada et al. (2019) for an example of an application of these metrics on corals.   
- **Convexity:** the ratio of the volume of the object and the volume of the convex hull around the object.     
- **Packing:** The ratio of the surface area of the object and the surface area of the convex hull around the object.    
- **Sphericity:** The ratio of the surface area of a sphere with the same volume as the object and the surface area of the object.             
- **Second moment of area (sma):** A measure of top-heaviness using area. Calculated by multiplying the surface area of each triangle in the mesh by its vertical distance from the origin.             
- **Second moment of volume (smv):** A measure of top-heaviness using volume. For each triangle in the mesh, a tetrahedron between the triangle and the origin was calculated. The signed volume of each tetrahedron was multiplied by the vertical distance between the centroid of the tetrahedron and the centroid of the attachment plane.       
- **Mechanical shape factor (csf):**  Mechanical vulnerability of a structural element (Madin & Connolly, 2006).             
```{r}
# convexity
convexity(mcap)

# packing
packing(mcap)

# sphericity
sphericity(mcap)

# second moment of area
sma(mcap)

# second moment of volume
smv(mcap)

# mechanical shape factor
csf(mcap, z_min = -3.65)

```



## References       
Zawada KJA, Dornelas M, Madin JS (2019) Quantifying coral morphology. Coral Reefs, 38:1281â€“1292.          
Madin JS & Connolly SR (2006) Ecological consequences of major hydrodynamic disturbances on coral reefs. Nature. 444:477-480.                





